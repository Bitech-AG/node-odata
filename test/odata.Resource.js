var PORT, bookSchema, conn, odata, request, should, support;

should = require('should');

request = require('supertest');

odata = require('../.');

support = require('./support');

PORT = 0;

bookSchema = {
  author: String,
  description: String,
  genre: String,
  price: Number,
  publish_date: Date,
  title: String
};

conn = 'mongodb://localhost/odata-test';

describe('odata.Resource', function() {
  return it('should be work', function(done) {
    var book, s, server;
    book = odata.Resource('book', bookSchema);
    server = odata(conn);
    server.use(book);
    return s = server.listen(PORT, function() {
      PORT = s.address().port;
      return request("http://localhost:" + PORT).post("/book").send({
        title: 'new'
      }).expect(201, done);
    });
  });
});

// ---
// generated by coffee-script 1.9.2
